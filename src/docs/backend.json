

{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile information.",
      "type": "object",
      "properties": {
        "uid": {
          "type": "string",
          "description": "The user's unique ID."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "role": {
          "type": "string",
          "enum": ["propietario", "administrador"],
          "description": "The user's role in the system."
        },
        "properties": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "street": { "type": "string" },
              "house": { "type": "string" }
            },
            "required": ["street", "house"]
          }
        },
        "balance": {
          "type": "number",
          "description": "The user's current account balance in Bs."
        },
        "passwordChanged": {
            "type": "boolean"
        }
      },
      "required": ["uid", "name", "email", "role"]
    },
    "Config": {
        "title": "Application Configuration",
        "description": "General settings for the application.",
        "type": "object",
        "properties": {
            "companyInfo": {
                "type": "object",
                "properties": {
                    "name": {"type": "string"},
                    "address": {"type": "string"},
                    "rif": {"type": "string"},
                    "phone": {"type": "string"},
                    "email": {"type": "string", "format": "email"},
                    "logo": {"type": "string", "format": "uri"},
                    "bankName": {"type": "string"},
                    "accountNumber": {"type": "string"}
                }
            },
            "condoFee": {
                "type": "number"
            },
            "exchangeRates": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "id": {"type": "string"},
                        "date": {"type": "string", "format": "date"},
                        "rate": {"type": "number"},
                        "active": {"type": "boolean"}
                    },
                    "required": ["id", "date", "rate", "active"]
                }
            },
            "loginSettings": {
                "type": "object",
                "properties": {
                    "ownerLoginEnabled": { "type": "boolean" },
                    "disabledMessage": { "type": "string" }
                }
            }
        }
    },
    "Authorization": {
      "title": "Authorization Configuration",
      "description": "Stores security-related configurations, like the authorization key.",
      "type": "object",
      "properties": {
        "key": {
          "type": "string",
          "description": "The master key required for critical administrative actions."
        }
      }
    },
    "Log": {
        "title": "Audit Log",
        "description": "A record of a significant system event for auditing purposes.",
        "type": "object",
        "properties": {
            "userId": {"type": "string"},
            "userName": {"type": "string"},
            "action": {"type": "string", "description": "e.g., 'authorization_attempt'"},
            "result": {"type": "string", "enum": ["success", "failure"]},
            "timestamp": {"type": "string", "format": "date-time"}
        }
    },
    "Payment": {
        "title": "Payment Record",
        "description": "A record of a payment made by a user.",
        "type": "object",
        "properties": {
            "reportedBy": {"type": "string"},
            "beneficiaryIds": {"type": "array", "items": {"type": "string"}},
            "totalAmount": {"type": "number"},
            "exchangeRate": {"type": "number"},
            "paymentDate": {"type": "string", "format": "date-time"},
            "reportedAt": {"type": "string", "format": "date-time"},
            "paymentMethod": {"type": "string", "enum": ["transferencia", "movil", "adelanto", "conciliacion", "efectivo_bs", "efectivo_usd"]},
            "bank": {"type": "string"},
            "reference": {"type": "string"},
            "status": {"type": "string", "enum": ["pendiente", "aprobado", "rechazado"]},
            "observations": {"type": "string"},
            "receiptUrl": {"type": "string", "format": "uri", "description": "Base64 encoded string of the receipt image."},
            "receiptNumbers": {
                "type": "object",
                "additionalProperties": { "type": "string" }
            }
        }
    },
    "Debt": {
        "title": "Debt Record",
        "description": "A record of a debt owed by a user.",
        "type": "object",
        "properties": {
            "ownerId": {"type": "string"},
            "property": {
                "type": "object",
                "properties": {
                    "street": {"type": "string"},
                    "house": {"type": "string"}
                }
            },
            "year": {"type": "number"},
            "month": {"type": "number"},
            "amountUSD": {"type": "number"},
            "description": {"type": "string"},
            "status": {"type": "string", "enum": ["pending", "paid", "vencida"]},
            "paidAmountUSD": {"type": "number"},
            "paymentDate": {"type": "string", "format": "date-time"},
            "paymentId": {"type": "string"}
        }
    },
     "Expense": {
        "title": "Expense",
        "description": "Represents an expense record for the condominium.",
        "type": "object",
        "properties": {
            "description": { "type": "string" },
            "amount": { "type": "number" },
            "paymentSource": { "type": "string", "enum": ["banco", "efectivo_bs", "efectivo_usd"]},
            "category": { "type": "string", "enum": ["Servicios", "Mantenimientos y Servicios", "Nomina", "Administracion", "Telefonia e Internet", "Gastos ExtraOrdinarios", "Reparaciones Generales", "Caja Chica", "Otros Gastos"] },
            "date": { "type": "string", "format": "date-time" },
            "createdAt": { "type": "string", "format": "date-time" },
            "reference": { "type": "string" }
        },
        "required": ["description", "amount", "category", "date", "paymentSource"]
    },
    "Certificate": {
        "title": "Certificate",
        "description": "A residence or solvency certificate.",
        "type": "object",
        "properties": {
            "ownerId": {"type": "string"},
            "ownerName": {"type": "string"},
            "ownerCedula": {"type": "string"},
            "property": {
                "type": "object",
                "properties": {
                    "street": {"type": "string"},
                    "house": {"type": "string"}
                }
            },
            "type": {"type": "string"},
            "body": {"type": "string"},
            "createdAt": {"type": "string", "format": "date-time"}
        }
    },
    "FinancialStatement": {
        "title": "Financial Statement",
        "description": "Monthly financial statements.",
        "type": "object",
        "properties": {
            "ingresos": {"type": "array", "items": {"$ref": "#/entities/FinancialItem"}},
            "egresos": {"type": "array", "items": {"$ref": "#/entities/FinancialItem"}},
            "estadoFinanciero": {
                "type": "object",
                "properties": {
                    "saldoNeto": {"type": "number"},
                    "saldoEfectivo": {"type": "number"}
                }
            },
            "notas": {"type": "string"},
            "createdAt": {"type": "string", "format": "date-time"}
        }
    },
    "FinancialItem": {
        "title": "Financial Item",
        "type": "object",
        "properties": {
            "id": {"type": "string"},
            "dia": {"type": "string"},
            "concepto": {"type": "string"},
            "monto": {"type": "number"},
            "category": {
                "type": "string",
                "enum": ["cuotas_ordinarias", "cuotas_especiales", "fondo_reserva", "deposito_en_transito", "otros"]
            },
            "date": {"type": "string", "format": "date-time"}
        }
    },
     "IntegralReport": {
      "title": "Integral Report",
      "description": "A saved instance of a generated integral report.",
      "type": "object",
      "properties": {
        "createdAt": { "type": "string", "format": "date-time" },
        "data": {
          "type": "array",
          "items": { "$ref": "#/entities/IntegralReportRow" }
        },
        "filters": {
          "type": "object",
          "properties": {
            "statusFilter": { "type": "string" },
            "ownerFilter": { "type": "string" },
            "dateRangeFrom": { "type": "string", "format": "date" },
            "dateRangeTo": { "type": "string", "format": "date" }
          }
        }
      }
    },
    "IntegralReportRow": {
      "title": "Integral Report Row",
      "description": "A single row within a saved integral report.",
      "type": "object",
      "properties": {
        "ownerId": { "type": "string" },
        "name": { "type": "string" },
        "properties": { "type": "string" },
        "lastPaymentDate": { "type": "string" },
        "paidAmount": { "type": "number" },
        "avgRate": { "type": "number" },
        "balance": { "type": "number" },
        "status": { "type": "string" },
        "solvencyPeriod": { "type": "string" },
        "monthsOwed": { "type": "number" },
        "adjustmentDebtUSD": { "type": "number" }
      }
    },
    "PublishedReport": {
        "title": "Published Report",
        "description": "Controls which reports are visible to owners.",
        "type": "object",
        "properties": {
            "type": {"type": "string", "enum": ["balance", "integral"]},
            "createdAt": {"type": "string", "format": "date-time"},
            "sourceId": {"type": "string", "description": "The ID of the source document in its respective collection (e.g., integral_reports)"}
        }
    },
    "PettyCash": {
        "title": "Petty Cash Replenishment",
        "description": "A record of a petty cash replenishment.",
        "type": "object",
        "properties": {
            "date": {"type": "string", "format": "date-time"},
            "amount": {"type": "number"},
            "description": {"type": "string"},
            "sourceExpenseId": { "type": "string"},
            "expenses": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "id": {"type": "string"},
                        "date": {"type": "string", "format": "date-time"},
                        "description": {"type": "string"},
                        "amount": {"type": "number"},
                        "receiptUrl": {"type": "string", "format": "uri"}
                    },
                    "required": ["id", "date", "description", "amount"]
                }
            }
        }
    },
    "Survey": {
        "title": "Survey",
        "description": "A survey for the community.",
        "type": "object",
        "properties": {
            "title": {"type": "string"},
            "questions": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "id": {"type": "string"},
                        "questionText": {"type": "string"},
                        "options": {"type": "array", "items": {"type": "string"}}
                    }
                }
            },
            "createdAt": {"type": "string", "format": "date-time"},
            "startDate": {"type": "string", "format": "date-time"},
            "endDate": {"type": "string", "format": "date-time"},
            "results": {
                "type": "object",
                "additionalProperties": {
                    "type": "object",
                    "additionalProperties": {"type": "number"}
                }
            },
            "totalVotes": {"type": "number"}
        }
    },
    "SurveyResponse": {
        "title": "Survey Response",
        "description": "A user's response to a survey.",
        "type": "object",
        "properties": {
            "surveyId": {"type": "string"},
            "userId": {"type": "string"},
            "responses": {
                "type": "object",
                "additionalProperties": {"type": "string"}
            },
            "votedAt": {"type": "string", "format": "date-time"}
        }
    },
    "AppFeedback": {
        "title": "App Feedback",
        "description": "Feedback about the application from users.",
        "type": "object",
        "properties": {
            "ownerId": {"type": "string"},
            "response": {"type": "string", "enum": ["liked", "disliked"]},
            "timestamp": {"type": "string", "format": "date-time"}
        }
    },
    "HistoricalPayment": {
        "title": "Historical Payment",
        "description": "Record of payments from past periods.",
        "type": "object",
        "properties": {
            "ownerId": {"type": "string"},
            "ownerName": {"type": "string"},
            "property": {
                "type": "object",
                "properties": {
                    "street": {"type": "string"},
                    "house": {"type": "string"}
                }
            },
            "referenceMonth": {"type": "number"},
            "referenceYear": {"type": "number"},
            "paymentDate": {"type": "string", "format": "date-time"},
            "amountUSD": {"type": "number"},
            "observations": {"type": "string"},
            "createdAt": {"type": "string", "format": "date-time"}
        }
    },
    "AdminTask": {
      "title": "Admin Task",
      "description": "A task created by an administrator to be processed by a backend function.",
      "type": "object",
      "properties": {
        "taskType": {
          "type": "string",
          "enum": ["changeEmail", "deleteUser"],
          "description": "The type of task to be performed."
        },
        "targetUID": {
          "type": "string",
          "description": "The UID of the user to be updated or deleted."
        },
        "newEmail": {
          "type": "string",
          "description": "The new email address (only for 'changeEmail' tasks)."
        },
        "status": {
          "type": "string",
          "enum": ["pending", "processing", "completed", "error"],
          "description": "The status of the task."
        },
        "requestedBy": {
          "type": "string",
          "description": "The UID of the administrator who initiated the task."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["taskType", "targetUID", "status", "requestedBy", "createdAt"]
    }
  },
  "firestore": {
    "/owners/{userId}": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Stores user profile information, including their role and properties."
    },
    "/config/{docId}": {
        "schema": { "$ref": "#/entities/Config" },
        "description": "Stores general application settings like company info and exchange rates."
    },
    "/config/authorization": {
      "schema": { "$ref": "#/entities/Authorization" },
      "description": "Stores the admin authorization key."
    },
    "/logs/{logId}": {
      "schema": { "$ref": "#/entities/Log" },
      "description": "Stores audit logs for important system events."
    },
    "/payments/{paymentId}": {
        "schema": { "$ref": "#/entities/Payment" },
        "description": "Stores payment records submitted by users."
    },
    "/debts/{debtId}": {
        "schema": { "$ref": "#/entities/Debt" },
        "description": "Tracks debts owed by each owner."
    },
    "/expenses/{expenseId}": {
        "schema": { "$ref": "#/entities/Expense" },
        "description": "Stores individual expense records."
    },
    "/certificates/{certId}": {
        "schema": { "$ref": "#/entities/Certificate" },
        "description": "Stores generated residence or solvency certificates."
    },
    "/financial_statements/{statementId}": {
        "schema": { "$ref": "#/entities/FinancialStatement" },
        "description": "Stores monthly financial statements."
    },
     "/integral_reports/{reportId}": {
      "schema": { "$ref": "#/entities/IntegralReport" },
      "description": "Stores generated instances of integral reports."
    },
    "/published_reports/{reportId}": {
        "schema": { "$ref": "#/entities/PublishedReport" },
        "description": "Controls which reports are visible to owners."
    },
    "/petty_cash_replenishments/{repId}": {
        "schema": { "$ref": "#/entities/PettyCash" },
        "description": "Stores petty cash replenishments and their associated expenses."
    },
    "/surveys/{surveyId}": {
        "schema": { "$ref": "#/entities/Survey" },
        "description": "Stores community surveys and their results."
    },
    "/survey_responses/{responseId}": {
        "schema": { "$ref": "#/entities/SurveyResponse" },
        "description": "Stores individual user responses to surveys."
    },
    "/app_feedback/{feedbackId}": {
        "schema": { "$ref": "#/entities/AppFeedback" },
        "description": "Stores feedback submitted by users about the application."
    },
    "/historical_payments/{histId}": {
        "schema": { "$ref": "#/entities/HistoricalPayment" },
        "description": "Stores historical payment records for past periods."
    },
    "/admin_tasks/{taskId}": {
        "schema": { "$ref": "#/entities/AdminTask" },
        "description": "Queue for administrative tasks to be processed by a backend function."
    }
  },
  "auth": {
    "providers": ["password", "google.com"]
  }
}


